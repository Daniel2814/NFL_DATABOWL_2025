
title: "Kickers Analysis"
author: "Your Name"
date: "`r Sys.Date()`"
output: html_document
---

# Kickers Data Analysis
```{r}
install.packages("dplyr")
library(dplyr)

install.packages("NFLfastR")
library(NFLfastR)
```

```{r}
csv_path <- '/Users/danielnickas/Downloads/NFL_DATABOWL_2025/NFL_kicker_proj/nfl_kick_attempts(in).csv'
print(paste('Loading data from:', csv_path))
```
 

```{r}
summary(nfl_kick_attempts)
```

```{r}
# Histogram of kick attempts by season
if (exists("nfl_kick_attempts") && "season" %in% names(nfl_kick_attempts)) {
  hist(nfl_kick_attempts$season,
       main = "Histogram of Kick Attempts by Season",
       xlab = "Season",
       ylab = "Number of Kick Attempts",
       col = "skyblue",
       border = "white")
} else {
  cat("Data frame or 'season' column not found.\n")
}
```

```{r}

# Find the most accurate kicking season, sorted by kicker_player_id, kick_type, extra_point, made
if (exists("nfl_kick_attempts") && all(c("kicker_player_id", "kick_type", "extra_point", "made", "season") %in% names(nfl_kick_attempts))) {
  library(dplyr)
  summary_tbl <- nfl_kick_attempts %>%
    group_by(season, kicker_player_id, kick_type, extra_point) %>%
    summarise(
      attempts = n(),
      made = sum(made, na.rm = TRUE),
      accuracy = made / attempts
    ) %>%
    arrange(desc(accuracy), desc(attempts))
  print(head(summary_tbl, 10))
  most_accurate <- summary_tbl %>% filter(accuracy == max(accuracy))
  cat("\nMost accurate season(s):\n")
  print(most_accurate)
} else {
  cat("Required columns not found in data.\n")
}
```


  # Bar plot of top 10 kicking accuracies by season and kicker using ggplot2
  ```{r}
  # Bar plot of top 10 kicking accuracies by season and kicker using ggplot2, with debug output
  if (!exists("summary_tbl")) {
    cat("summary_tbl does not exist.\n")
  } else if (!requireNamespace("ggplot2", quietly = TRUE)) {
    cat("ggplot2 is not available.\n")
  } else {
    library(ggplot2)
    top10 <- head(summary_tbl, 10)
    print(top10)
    ggplot(top10, aes(x = factor(season), y = accuracy, fill = kicker_player_id)) +
      geom_bar(stat = "identity", position = position_dodge()) +
      labs(title = "Top 10 Kicking Accuracies by Season and Kicker",
           x = "Season", y = "Accuracy") +
      theme_minimal()
  }
```

  ```{r}
  # Bar plot: Most accurate kickers of 2013 by kicker_player_id
  library(dplyr)
  library(ggplot2)
  kicker_2013 <- nfl_kick_attempts %>%
    filter(season == 2013) %>%
    group_by(kicker_player_id) %>%
    summarise(
      attempts = n(),
      made = sum(made, na.rm = TRUE),
      accuracy = made / attempts
    ) %>%
    arrange(desc(accuracy))

  ggplot(kicker_2013, aes(x = reorder(kicker_player_id, -accuracy), y = accuracy)) +
    geom_bar(stat = "identity", fill = "#008cff") +
    labs(title = "Most Accurate Kickers of 2013",
         x = "Kicker Player ID", y = "Accuracy") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
# List all column names in nfl_kick_attempts for debugging
print(names(nfl_kick_attempts))
```

```{r}
# Display the name of kicker with kicker_player_id '00-0019536'
kicker_id <- '00-0019536'
kicker <- nfl_kick_attempts %>%
  filter(kicker_player_id == kicker_id) %>%
  select(kicker_player_name) %>% distinct() %>%
print(kicker_name)
```



